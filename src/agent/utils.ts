import { BaseStore, LangGraphRunnableConfig } from "@langchain/langgraph";
import { Reflections } from "../types";

export const formatReflections = (reflections: Reflections): string => {
  const styleString = `The following is a list of style guidelines previously generated by you:
<style-guidelines>
- ${reflections.styleRules.join("\n- ")}
</style-guidelines>`;
  const contentString = `The following is a list of memories/facts you previously generated about the user:
<user-facts>
- ${reflections.content.join("\n- ")}
</user-facts>`;

  return styleString + "\n\n" + contentString;
};

export const ensureStoreInConfig = (
  config: LangGraphRunnableConfig
): BaseStore => {
  if (!config.store) {
    throw new Error("`store` not found in config");
  }
  return config.store;
};
